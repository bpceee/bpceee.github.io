<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link rel="preload" as="font" href="/_next/static/media/710e6adf42e8fe6f-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/7b379c56c483b024-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/7b9ca6a1d31c5662-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/931105f8d96e7f26-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/d9957a565b52891d-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/fbdbe464b9e5cc95-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="preload" as="font" href="/_next/static/media/1060bab20f18b5c2-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/02482d46f001465e.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/ca4b413b104171a1.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/01cb1f6bc3109902.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-f193c89af52c9246.js" as="script"/><link rel="preload" href="/_next/static/chunks/bce60fc1-ace986fa93a43fca.js" as="script"/><link rel="preload" href="/_next/static/chunks/698-2449c10902a17a12.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-app-264da4a89861ff42.js" as="script"/><meta name="next-size-adjust"/><title>Analysis on a vertical alignment issue in CSS</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="any"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body style="margin-left:auto;margin-right:auto;max-width:49rem;padding:0px 1.3125rem" class="__className_135483"><nav class="Navbar_navbar__fk_p7"><a href="/"> Home </a><a href="/about"> About </a></nav><main class="Layout_main__luTTh"><article class="Post_blogPost__gpu0n"><header><h1 class="__className_cabfd8">Analysis on a vertical alignment issue in CSS</h1><p class="Post_meta__oz6mK">Published <span>10 Jul 2023</span> <!-- -->· tagged with<!-- --> <a class="PostTags_tag__ommYO" href="?tag=css">css</a></p></header><div class="markdown-body"><html><head></head><body><p dir="auto">So I came across <a href="https://www.aha.io/engineering/articles/css-is-hard-no-matter-how-good-you-are-at-it" rel="nofollow">this blog post</a> when browsing Aha!'s engineering blog. The acknowledgement that CSS is challenging and the methodically structured approach they are taking to address the problem resonates with me.</p>
<p dir="auto">At the end of the article, it states, "If you know the reason or have a different solution, we would love to hear from you." So, here I am, attempting to find a reason and perhaps offer a different solution.</p>
<h2 dir="auto">The Problem</h2>
<p dir="auto">An <code class="notranslate">img</code> tag causing misalignment.</p>
<p dir="auto"><div>
      <p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="rNrPYNQ" data-user="jsteel64" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
        <a href="">Refresh page to view</a>
        <span>&nbsp;or&nbsp;</span> 
        <a href="https://codepen.io/jsteel64/pen/rNrPYNQ">
          View on CodePen
        </a>.
      </p>
      </div></p>
<h2 dir="auto">The Cause</h2>
<p dir="auto">After some sandboxing and googling around, it appears the issue is related to <a href="https://www.w3.org/TR/css-inline-3/#alignment" rel="nofollow">baseline alignment</a>. By examining the DOM tree structure, we can divide it into two parts: the alignment of the two inline-box <code class="notranslate">pill</code> span elements and the <a href="https://www.w3.org/TR/css-align-3/#baseline-export" rel="nofollow">determination of the baseline</a> for the <code class="notranslate">wrapper</code> flex container.</p>
<h3 dir="auto">1. Inline box baseline alignment</h3>
<p dir="auto">According to w3 document for <a href="https://www.w3.org/TR/css-inline-3/#alignment" rel="nofollow">baseline alignment</a>:</p>
<blockquote>
<p dir="auto">While most CSS&nbsp;<a href="https://www.w3.org/TR/css-display-3/#formatting-context" rel="nofollow">formatting contexts</a>&nbsp;position content by aligning boxes with respect to their container’s edges,&nbsp;<strong><a href="https://www.w3.org/TR/css-inline-3/#inline-layout" rel="nofollow">inline layout</a>&nbsp;positions boxes in the&nbsp;<a href="https://www.w3.org/TR/css-writing-modes-4/#block-axis" rel="nofollow">block axis</a> by aligning them with respect to each other using their&nbsp;<a href="https://www.w3.org/TR/css-inline-3/#baseline" rel="nofollow">baselines</a>.</strong></p>
</blockquote>
<p dir="auto">A very clear example from here: <a href="https://infoheap.com/css-inline-block-baseline-alignment/" rel="nofollow">https://infoheap.com/css-inline-block-baseline-alignment/</a></p>
<p dir="auto"><a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/4188573/252216999-dff44aed-85b0-4c73-8c69-f94abe95b165.png"><img src="https://user-images.githubusercontent.com/4188573/252216999-dff44aed-85b0-4c73-8c69-f94abe95b165.png" alt="image" style="max-width: 100%;"></a></p>
<p dir="auto"><div>
      <p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="QWJOLbm" data-user="bpceee-the-typescripter" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
        <a href="">Refresh page to view</a>
        <span>&nbsp;or&nbsp;</span> 
        <a href="https://codepen.io/bpceee-the-typescripter/pen/QWJOLbm">
          View on CodePen
        </a>.
      </p>
      </div></p>
<a target="_blank" rel="noopener noreferrer" href="https://user-images.githubusercontent.com/4188573/252217132-578b4431-f721-4bd9-8ef3-7b6af72a81f9.png"><img src="https://user-images.githubusercontent.com/4188573/252217132-578b4431-f721-4bd9-8ef3-7b6af72a81f9.png" width="300" style="max-width: 100%;"></a>
<p dir="auto">So back to our problem, the “Pill 2”’s baseline somehow lies on <code class="notranslate">img</code> tag. But why?</p>
<h3 dir="auto">2. <strong>Determining f</strong>lex container baseline</h3>
<p dir="auto">Understanding related rules in w3 is quite challenging: <a href="https://www.w3.org/TR/css-flexbox-1/#flex-baselines" rel="nofollow">https://www.w3.org/TR/css-flexbox-1/#flex-baselines</a></p>
<p dir="auto">A plausible(wild) guess would be that it falls in to the second rule:</p>
<blockquote>
<p dir="auto">if the flex container has at least one&nbsp;<a href="https://www.w3.org/TR/css-flexbox-1/#flex-item" rel="nofollow">flex item</a>, the flex container’s first/last&nbsp;<a href="https://www.w3.org/TR/css-flexbox-1/#main-axis-baseline" rel="nofollow">main-axis baseline set</a>&nbsp;is&nbsp;<a href="https://www.w3.org/TR/css3-align/#generate-baselines" rel="nofollow">generated</a>&nbsp;from the&nbsp;<a href="https://www.w3.org/TR/css3-align/#alignment-baseline" rel="nofollow">alignment baseline</a>&nbsp;of the startmost/endmost&nbsp;<a href="https://www.w3.org/TR/css-flexbox-1/#flex-item" rel="nofollow">flex item</a>.</p>
</blockquote>
<p dir="auto">So in the original problem, the alignment baseline of the flexbox container corresponds to the alignment baseline of the first flex item, which is the <code class="notranslate">img</code> alignment baseline.</p>
<p dir="auto">Here is an example where the first element is bigger than the second:</p>
<p dir="auto"><div>
      <p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="yLQPBXG" data-user="bpceee-the-typescripter" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
        <a href="">Refresh page to view</a>
        <span>&nbsp;or&nbsp;</span> 
        <a href="https://codepen.io/bpceee-the-typescripter/pen/yLQPBXG">
          View on CodePen
        </a>.
      </p>
      </div></p>
<p dir="auto">The solution in the original blog post works because it adds a zero width space first child, which has a same height as the second child since they have the same default font size.</p>
<p dir="auto">But what if they don’t have the same height?</p>
<p dir="auto"><div>
      <p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="KKryPvG" data-user="bpceee-the-typescripter" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
        <a href="">Refresh page to view</a>
        <span>&nbsp;or&nbsp;</span> 
        <a href="https://codepen.io/bpceee-the-typescripter/pen/KKryPvG">
          View on CodePen
        </a>.
      </p>
      </div></p>
<p dir="auto">Here, text in <code class="notranslate">span</code> are set to 32px explicitly, but the content in the pseudo element is still default to 16px. Boom, misaligned again.</p>
<h2 dir="auto">Alternative solution</h2>
<p dir="auto">Wrap them around a flexbox container.</p>
<p dir="auto"><div>
      <p class="codepen" data-height="300" data-default-tab="html,result" data-slug-hash="wvQPwyj" data-user="bpceee-the-typescripter" style="height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;">
        <a href="">Refresh page to view</a>
        <span>&nbsp;or&nbsp;</span> 
        <a href="https://codepen.io/bpceee-the-typescripter/pen/wvQPwyj">
          View on CodePen
        </a>.
      </p>
      </div></p>
<p dir="auto">But yeah, it’s might not be suitable to make such change in a large codebase.</p></body></html></div></article></main><footer class="Layout_footer__U3vTh"><hr/><small>© <!-- -->2023<!-- --> Ken Bi. Powered by<!-- --> <a href="https://github.com/bpceee/isblog" rel="noopener noreferrer" target="_blank">isBlog</a></small></footer><script src="/_next/static/chunks/webpack-f193c89af52c9246.js" async=""></script><script src="/_next/static/chunks/bce60fc1-ace986fa93a43fca.js" async=""></script><script src="/_next/static/chunks/698-2449c10902a17a12.js" async=""></script><script src="/_next/static/chunks/main-app-264da4a89861ff42.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/710e6adf42e8fe6f-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/7b379c56c483b024-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/media/7b9ca6a1d31c5662-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n4:HL[\"/_next/static/media/931105f8d96e7f26-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n5:HL[\"/_next/static/media/d9957a565b52891d-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n6:HL[\"/_next/static/media/fbdbe464b9e5cc95-s.p.woff2\",{\"as\":\"font\","])</script><script>self.__next_f.push([1,"\"type\":\"font/woff2\"}]\n7:HL[\"/_next/static/css/02482d46f001465e.css\",{\"as\":\"style\"}]\n0:\"$L8\"\n"])</script><script>self.__next_f.push([1,"9:HL[\"/_next/static/media/1060bab20f18b5c2-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\na:HL[\"/_next/static/css/ca4b413b104171a1.css\",{\"as\":\"style\"}]\nb:HL[\"/_next/static/css/01cb1f6bc3109902.css\",{\"as\":\"style\"}]\n"])</script><script>self.__next_f.push([1,"c:I{\"id\":2353,\"chunks\":[\"272:static/chunks/webpack-f193c89af52c9246.js\",\"253:static/chunks/bce60fc1-ace986fa93a43fca.js\",\"698:static/chunks/698-2449c10902a17a12.js\"],\"name\":\"default\",\"async\":false}\ne:I{\"id\":7330,\"chunks\":[\"272:static/chunks/webpack-f193c89af52c9246.js\",\"253:static/chunks/bce60fc1-ace986fa93a43fca.js\",\"698:static/chunks/698-2449c10902a17a12.js\"],\"name\":\"\",\"async\":false}\nf:I{\"id\":7095,\"chunks\":[\"95:static/chunks/95-072377135f6d2de2.js\",\"333:static/chunks/app/posts/[slug]/page-4722c50ea842cb57"])</script><script>self.__next_f.push([1,".js\"],\"name\":\"\",\"async\":false}\n11:I{\"id\":9180,\"chunks\":[\"272:static/chunks/webpack-f193c89af52c9246.js\",\"253:static/chunks/bce60fc1-ace986fa93a43fca.js\",\"698:static/chunks/698-2449c10902a17a12.js\"],\"name\":\"default\",\"async\":false}\n12:I{\"id\":2306,\"chunks\":[\"272:static/chunks/webpack-f193c89af52c9246.js\",\"253:static/chunks/bce60fc1-ace986fa93a43fca.js\",\"698:static/chunks/698-2449c10902a17a12.js\"],\"name\":\"default\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"8:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/02482d46f001465e.css\",\"precedence\":\"next\"}]],[\"$\",\"$Lc\",null,{\"buildId\":\"5Uvh9U9SdH-8kKw5Aitn6\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/13\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"13\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"13\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[\"$Ld\",[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\"}]],\"globalErrorComponent\":\"$e\",\"notFound\":[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"style\":{\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"49rem\",\"padding\":\"0px 1.3125rem\"},\"className\":\"__className_135483\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"Navbar_navbar__fk_p7\",\"children\":[[\"$\",\"$Lf\",null,{\"href\":\"/\",\"children\":\" Home \"}],[\"$\",\"$Lf\",null,{\"href\":\"/about\",\"children\":\" About \"}]]}],[\"$\",\"main\",null,{\"className\":\"Layout_main__luTTh\",\"children\":[\"$L10\",\"$undefined\",[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]]}],[\"$\",\"footer\",null,{\"className\":\"Layout_footer__U3vTh\",\"children\":[[\"$\",\"hr\",null,{}],[\"$\",\"small\",null,{\"children\":[\"© \",2023,\" Ken Bi. Powered by\",\" \",[\"$\",\"a\",null,{\"href\":\"https://github.com/bpceee/isblog\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"children\":\"isBlog\"}]]}]]}]]}]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"style\":{\"marginLeft\":\"auto\",\"marginRight\":\"auto\",\"maxWidth\":\"49rem\",\"padding\":\"0px 1.3125rem\"},\"className\":\"__className_135483\",\"children\":[[\"$\",\"nav\",null,{\"className\":\"Navbar_navbar__fk_p7\",\"children\":[[\"$\",\"$Lf\",null,{\"href\":\"/\",\"children\":\" Home \"}],[\"$\",\"$Lf\",null,{\"href\":\"/about\",\"children\":\" About \"}]]}],[\"$\",\"main\",null,{\"className\":\"Layout_main__luTTh\",\"children\":[\"$\",\"$L11\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L12\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L11\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L12\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L11\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"slug\",\"13\",\"d\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$L12\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$L13\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"13\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ca4b413b104171a1.css\",\"precedence\":\"next\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/01cb1f6bc3109902.css\",\"precedence\":\"next\"}]]}],\"segment\":[\"slug\",\"13\",\"d\"]},\"styles\":[]}],\"segment\":\"posts\"},\"styles\":[]}]}],[\"$\",\"footer\",null,{\"className\":\"Layout_footer__U3vTh\",\"children\":[[\"$\",\"hr\",null,{}],[\"$\",\"small\",null,{\"children\":[\"© \",2023,\" Ken Bi. Powered by\",\" \",[\"$\",\"a\",null,{\"href\":\"https://github.com/bpceee/isblog\",\"rel\":\"noopener noreferrer\",\"target\":\"_blank\",\"children\":\"isBlog\"}]]}]]}]]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"10:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"15:I{\"id\":5282,\"chunks\":[\"95:static/chunks/95-072377135f6d2de2.js\",\"333:static/chunks/app/posts/[slug]/page-4722c50ea842cb57.js\"],\"name\":\"Utterance\",\"async\":false}\n16:I{\"id\":3926,\"chunks\":[\"95:static/chunks/95-072377135f6d2de2.js\",\"333:static/chunks/app/posts/[slug]/page-4722c50ea842cb57.js\"],\"name\":\"CodePenScript\",\"async\":false}\n14:T1e37,"])</script><script>self.__next_f.push([1,"\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003cp dir=\"auto\"\u003eSo I came across \u003ca href=\"https://www.aha.io/engineering/articles/css-is-hard-no-matter-how-good-you-are-at-it\" rel=\"nofollow\"\u003ethis blog post\u003c/a\u003e when browsing Aha!'s engineering blog. The acknowledgement that CSS is challenging and the methodically structured approach they are taking to address the problem resonates with me.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eAt the end of the article, it states, \"If you know the reason or have a different solution, we would love to hear from you.\" So, here I am, attempting to find a reason and perhaps offer a different solution.\u003c/p\u003e\n\u003ch2 dir=\"auto\"\u003eThe Problem\u003c/h2\u003e\n\u003cp dir=\"auto\"\u003eAn \u003ccode class=\"notranslate\"\u003eimg\u003c/code\u003e tag causing misalignment.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cdiv\u003e\n      \u003cp class=\"codepen\" data-height=\"300\" data-default-tab=\"html,result\" data-slug-hash=\"rNrPYNQ\" data-user=\"jsteel64\" style=\"height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\"\u003e\n        \u003ca href=\"\"\u003eRefresh page to view\u003c/a\u003e\n        \u003cspan\u003e\u0026nbsp;or\u0026nbsp;\u003c/span\u003e \n        \u003ca href=\"https://codepen.io/jsteel64/pen/rNrPYNQ\"\u003e\n          View on CodePen\n        \u003c/a\u003e.\n      \u003c/p\u003e\n      \u003c/div\u003e\u003c/p\u003e\n\u003ch2 dir=\"auto\"\u003eThe Cause\u003c/h2\u003e\n\u003cp dir=\"auto\"\u003eAfter some sandboxing and googling around, it appears the issue is related to \u003ca href=\"https://www.w3.org/TR/css-inline-3/#alignment\" rel=\"nofollow\"\u003ebaseline alignment\u003c/a\u003e. By examining the DOM tree structure, we can divide it into two parts: the alignment of the two inline-box \u003ccode class=\"notranslate\"\u003epill\u003c/code\u003e span elements and the \u003ca href=\"https://www.w3.org/TR/css-align-3/#baseline-export\" rel=\"nofollow\"\u003edetermination of the baseline\u003c/a\u003e for the \u003ccode class=\"notranslate\"\u003ewrapper\u003c/code\u003e flex container.\u003c/p\u003e\n\u003ch3 dir=\"auto\"\u003e1. Inline box baseline alignment\u003c/h3\u003e\n\u003cp dir=\"auto\"\u003eAccording to w3 document for \u003ca href=\"https://www.w3.org/TR/css-inline-3/#alignment\" rel=\"nofollow\"\u003ebaseline alignment\u003c/a\u003e:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eWhile most CSS\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css-display-3/#formatting-context\" rel=\"nofollow\"\u003eformatting contexts\u003c/a\u003e\u0026nbsp;position content by aligning boxes with respect to their container’s edges,\u0026nbsp;\u003cstrong\u003e\u003ca href=\"https://www.w3.org/TR/css-inline-3/#inline-layout\" rel=\"nofollow\"\u003einline layout\u003c/a\u003e\u0026nbsp;positions boxes in the\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css-writing-modes-4/#block-axis\" rel=\"nofollow\"\u003eblock axis\u003c/a\u003e by aligning them with respect to each other using their\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css-inline-3/#baseline\" rel=\"nofollow\"\u003ebaselines\u003c/a\u003e.\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003eA very clear example from here: \u003ca href=\"https://infoheap.com/css-inline-block-baseline-alignment/\" rel=\"nofollow\"\u003ehttps://infoheap.com/css-inline-block-baseline-alignment/\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/4188573/252216999-dff44aed-85b0-4c73-8c69-f94abe95b165.png\"\u003e\u003cimg src=\"https://user-images.githubusercontent.com/4188573/252216999-dff44aed-85b0-4c73-8c69-f94abe95b165.png\" alt=\"image\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cdiv\u003e\n      \u003cp class=\"codepen\" data-height=\"300\" data-default-tab=\"html,result\" data-slug-hash=\"QWJOLbm\" data-user=\"bpceee-the-typescripter\" style=\"height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\"\u003e\n        \u003ca href=\"\"\u003eRefresh page to view\u003c/a\u003e\n        \u003cspan\u003e\u0026nbsp;or\u0026nbsp;\u003c/span\u003e \n        \u003ca href=\"https://codepen.io/bpceee-the-typescripter/pen/QWJOLbm\"\u003e\n          View on CodePen\n        \u003c/a\u003e.\n      \u003c/p\u003e\n      \u003c/div\u003e\u003c/p\u003e\n\u003ca target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://user-images.githubusercontent.com/4188573/252217132-578b4431-f721-4bd9-8ef3-7b6af72a81f9.png\"\u003e\u003cimg src=\"https://user-images.githubusercontent.com/4188573/252217132-578b4431-f721-4bd9-8ef3-7b6af72a81f9.png\" width=\"300\" style=\"max-width: 100%;\"\u003e\u003c/a\u003e\n\u003cp dir=\"auto\"\u003eSo back to our problem, the “Pill 2”’s baseline somehow lies on \u003ccode class=\"notranslate\"\u003eimg\u003c/code\u003e tag. But why?\u003c/p\u003e\n\u003ch3 dir=\"auto\"\u003e2. \u003cstrong\u003eDetermining f\u003c/strong\u003elex container baseline\u003c/h3\u003e\n\u003cp dir=\"auto\"\u003eUnderstanding related rules in w3 is quite challenging: \u003ca href=\"https://www.w3.org/TR/css-flexbox-1/#flex-baselines\" rel=\"nofollow\"\u003ehttps://www.w3.org/TR/css-flexbox-1/#flex-baselines\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eA plausible(wild) guess would be that it falls in to the second rule:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp dir=\"auto\"\u003eif the flex container has at least one\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css-flexbox-1/#flex-item\" rel=\"nofollow\"\u003eflex item\u003c/a\u003e, the flex container’s first/last\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css-flexbox-1/#main-axis-baseline\" rel=\"nofollow\"\u003emain-axis baseline set\u003c/a\u003e\u0026nbsp;is\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css3-align/#generate-baselines\" rel=\"nofollow\"\u003egenerated\u003c/a\u003e\u0026nbsp;from the\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css3-align/#alignment-baseline\" rel=\"nofollow\"\u003ealignment baseline\u003c/a\u003e\u0026nbsp;of the startmost/endmost\u0026nbsp;\u003ca href=\"https://www.w3.org/TR/css-flexbox-1/#flex-item\" rel=\"nofollow\"\u003eflex item\u003c/a\u003e.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp dir=\"auto\"\u003eSo in the original problem, the alignment baseline of the flexbox container corresponds to the alignment baseline of the first flex item, which is the \u003ccode class=\"notranslate\"\u003eimg\u003c/code\u003e alignment baseline.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHere is an example where the first element is bigger than the second:\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cdiv\u003e\n      \u003cp class=\"codepen\" data-height=\"300\" data-default-tab=\"html,result\" data-slug-hash=\"yLQPBXG\" data-user=\"bpceee-the-typescripter\" style=\"height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\"\u003e\n        \u003ca href=\"\"\u003eRefresh page to view\u003c/a\u003e\n        \u003cspan\u003e\u0026nbsp;or\u0026nbsp;\u003c/span\u003e \n        \u003ca href=\"https://codepen.io/bpceee-the-typescripter/pen/yLQPBXG\"\u003e\n          View on CodePen\n        \u003c/a\u003e.\n      \u003c/p\u003e\n      \u003c/div\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eThe solution in the original blog post works because it adds a zero width space first child, which has a same height as the second child since they have the same default font size.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBut what if they don’t have the same height?\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cdiv\u003e\n      \u003cp class=\"codepen\" data-height=\"300\" data-default-tab=\"html,result\" data-slug-hash=\"KKryPvG\" data-user=\"bpceee-the-typescripter\" style=\"height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\"\u003e\n        \u003ca href=\"\"\u003eRefresh page to view\u003c/a\u003e\n        \u003cspan\u003e\u0026nbsp;or\u0026nbsp;\u003c/span\u003e \n        \u003ca href=\"https://codepen.io/bpceee-the-typescripter/pen/KKryPvG\"\u003e\n          View on CodePen\n        \u003c/a\u003e.\n      \u003c/p\u003e\n      \u003c/div\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eHere, text in \u003ccode class=\"notranslate\"\u003espan\u003c/code\u003e are set to 32px explicitly, but the content in the pseudo element is still default to 16px. Boom, misaligned again.\u003c/p\u003e\n\u003ch2 dir=\"auto\"\u003eAlternative solution\u003c/h2\u003e\n\u003cp dir=\"auto\"\u003eWrap them around a flexbox container.\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e\u003cdiv\u003e\n      \u003cp class=\"codepen\" data-height=\"300\" data-default-tab=\"html,result\" data-slug-hash=\"wvQPwyj\" data-user=\"bpceee-the-typescripter\" style=\"height: 300px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;\"\u003e\n        \u003ca href=\"\"\u003eRefresh page to view\u003c/a\u003e\n        \u003cspan\u003e\u0026nbsp;or\u0026nbsp;\u003c/span\u003e \n        \u003ca href=\"https://codepen.io/bpceee-the-typescripter/pen/wvQPwyj\"\u003e\n          View on CodePen\n        \u003c/a\u003e.\n      \u003c/p\u003e\n      \u003c/div\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eBut yeah, it’s might not be suitable to make such change in a large codebase.\u003c/p\u003e\u003c/body\u003e\u003c/html\u003e"])</script><script>self.__next_f.push([1,"13:[\"$\",\"article\",null,{\"className\":\"Post_blogPost__gpu0n\",\"children\":[[\"$\",\"header\",null,{\"children\":[[\"$\",\"h1\",null,{\"className\":\"__className_cabfd8\",\"children\":\"Analysis on a vertical alignment issue in CSS\"}],[\"$\",\"p\",null,{\"className\":\"Post_meta__oz6mK\",\"children\":[\"Published \",[\"$\",\"span\",null,{\"className\":\"$undefined\",\"children\":\"10 Jul 2023\"}],[\" \",\"· tagged with\",[[\" \",[\"$\",\"$Lf\",\"0\",{\"className\":\"PostTags_tag__ommYO\",\"href\":\"?tag=css\",\"children\":\"css\"}]]]]]}]]}],[\"$\",\"div\",null,{\"className\":\"markdown-body\",\"dangerouslySetInnerHTML\":{\"__html\":\"$14\"}}],[\"$\",\"$L15\",null,{\"postId\":13}],[\"$\",\"$L16\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Analysis on a vertical alignment issue in CSS\"}],[\"$\",\"meta\",\"2\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"any\"}]]\n"])</script></body></html>